# `domain/values`

VO（値オブジェクト）

## 概要

- VO はデータとふるまい（関数）を保持できるオブジェクトである

## 実装方針

- プリミティブ型だと表現が難しい属性を持つ場合、その属性を VO とする
  - たとえば、その属性特有のルール（バリデーションチェックなど）を実装する場合など
- 可能な限り、Entity ではなく VO で実装することを考える
- 属性は`private`&`readonly`で宣言する
  ```ts
  readonly #id: string
  ```
  - TypeScript の private 修飾子は使わない
    - コンパイルエラーになるが、ランタイムエラーにならないから
  - readonly 修飾子でコンストラクターからのみ値の変更を許可する
    - つまり、VO のコンストラクターはインスタンス生成時にすべての属性値を作成できる機能であること

### 不変性

- VO は自身のコンストラクターからのみ初期値を設定することができ、いったん VO を作成したら値を変更することはできない
- 値を変更するふるまい（関数など）を VO 内に定義しない
  - 値を変更したい場合は、値を置き換えるという手段を取る（後述の交換可能性）

### 概念的な統一体

- VO は 1 つまたは複数の属性を保持しており、それらは高い凝集性がある
- VO 内のすべての属性が合わさって、VO を定量化・説明できる意味を持つ要素となる

### 交換可能性

- 不変性を保持しているため変更はできないが、新しい値で置き換えることはできる
  ```ts
  let id = new EmployeeId('A12345')
  id = new EmployeeId('B12345')
  ```

### 値の等価性

- 2 つの VO が等しいか比較する処理を実装する場合は、VO のすべての属性の型と値が等しいという条件にする必要がある

### 副作用がない

- VO 内の関数はすべて副作用がない関数にする

## 検討事項

- VO のテストは書いていない
  - ユースケースでテストを実施している
